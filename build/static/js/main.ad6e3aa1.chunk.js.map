{"version":3,"sources":["index.js"],"names":["Gallery","state","disableForm","query","searchText","handleSubmit","e","preventDefault","props","transition","handleChangeQuery","setState","target","value","this","encodedQuery","encodeURIComponent","setTimeout","fetchJsonp","jsonpCallback","then","res","json","items","catch","className","machineState","onSubmit","disabled","placeholder","type","onChange","show","onClick","map","item","i","src","media","m","style","photo","link","React","Component","App","withStatechart","initial","states","start","on","SEARCH","loading","SEARCH_SUCCESS","SEARCH_FAILURE","CANCEL_SEARCH","onEntry","onExit","error","gallery","SELECT_PHOTO","EXIT_PHOTO","initialData","ReactDOM","render","document","getElementById"],"mappings":"2NA8CMA,E,4MACJC,MAAQ,CACNC,aAAa,EACbC,MAAO,GACPC,WAAY,U,EAkCdC,aAAe,SAAAC,GACbA,EAAEC,iBACF,EAAKC,MAAMC,WAAW,W,EAGxBC,kBAAoB,SAAAJ,GAClB,EAAKK,SAAS,CAAER,MAAOG,EAAEM,OAAOC,S,kDArClC,WAAgB,IAAD,OACbC,KAAKH,SAAS,CACZT,aAAa,EACbE,WAAY,iBAGd,IAAMW,EAAeC,mBAAmBF,KAAKb,MAAME,OACnDc,YAAW,WACTC,IAAW,uFAAD,OAC+EH,GACvF,CAAEI,cAAe,iBAEhBC,MAAK,SAAAC,GAAG,OAAIA,EAAIC,UAChBF,MAAK,gBAAGG,EAAH,EAAGA,MAAH,OAAe,EAAKf,MAAMC,WAAW,iBAAkB,CAAEc,aAC9DC,OAAM,kBAAM,EAAKhB,MAAMC,WAAW,uBACpC,O,yBAGL,WACEK,KAAKH,SAAS,CACZT,aAAa,EACbE,WAAY,a,wBAIhB,WACEU,KAAKH,SAAS,CACZP,WAAY,uB,oBAahB,WAAU,IAAD,OACP,OACE,sBAAKqB,UAAU,SAAS,aAAYX,KAAKN,MAAMkB,aAA/C,UACE,uBAAMD,UAAU,UAAUE,SAAUb,KAAKT,aAAzC,UACE,uBACEoB,UAAU,WACVG,SAAUd,KAAKb,MAAMC,YACrB2B,YAAY,UACZC,KAAK,SACLjB,MAAOC,KAAKb,MAAME,MAClB4B,SAAUjB,KAAKJ,oBAEjB,sBAAKe,UAAU,aAAf,UACE,wBAAQA,UAAU,YAAYG,SAAUd,KAAKb,MAAMC,YAAnD,SACGY,KAAKb,MAAMG,aAEd,cAAC,SAAD,CAAQ4B,KAAK,eAAb,SACE,wBACEP,UAAU,YACVK,KAAK,SACLG,QAAS,kBAAM,EAAKzB,MAAMC,WAAW,kBAHvC,4BAWN,0BAASgB,UAAU,WAAnB,UACE,cAAC,SAAD,CAAQO,KAAK,aAAb,SACE,sBAAMP,UAAU,WAAhB,qCAEDX,KAAKN,MAAMe,MAAMW,KAAI,SAACC,EAAMC,GAAP,OACpB,qBACEX,UAAU,UAEVY,IAAKF,EAAKG,MAAMC,EAChBC,MAAO,CAAE,MAAOJ,GAChBH,QAAS,kBACP,EAAKzB,MAAMC,WAAW,eAAgB,CAAEgC,MAAON,MAJ5CA,EAAKO,YAShB,cAAC,SAAD,CAAQV,KAAK,aAAb,SACE,yBACEP,UAAU,kBACVQ,QAAS,kBAAM,EAAKzB,MAAMC,WAAW,eAFvC,SAIE,qBAAKgB,UAAU,WAAWY,IAAKvB,KAAKN,MAAMiC,MAAMH,MAAMC,e,GAhG5CI,IAAMC,WA+GtBC,EAAMC,yBAtJO,CACjBC,QAAS,QACTC,OAAQ,CACNC,MAAO,CACLC,GAAI,CACFC,OAAQ,YAGZC,QAAS,CACPF,GAAI,CACFG,eAAgB,UAChBC,eAAgB,QAChBC,cAAe,WAEjBC,QAAS,eACTC,OAAQ,eAEVC,MAAO,CACLR,GAAI,CACFC,OAAQ,WAEVK,QAAS,cAEXG,QAAS,CACPT,GAAI,CACFC,OAAQ,UACRS,aAAc,SAEhBJ,QAAS,gBAEXf,MAAO,CACLS,GAAI,CACFW,WAAY,WAEdL,QAAS,gBAoHwB,CAAEM,YAPrB,CAClBvC,MAAO,GACPkB,MAAO,CACLH,MAAO,MAICQ,CAA4C9C,GAExD+D,IAASC,OAAO,cAACnB,EAAD,IAASoB,SAASC,eAAe,U","file":"static/js/main.ad6e3aa1.chunk.js","sourcesContent":["import React from 'react'\nimport ReactDOM from 'react-dom'\nimport fetchJsonp from 'fetch-jsonp'\nimport { Action, withStatechart } from 'react-automata'\nimport 'normalize.css'\nimport './style.css'\n\nconst statechart = {\n  initial: 'start',\n  states: {\n    start: {\n      on: {\n        SEARCH: 'loading',\n      },\n    },\n    loading: {\n      on: {\n        SEARCH_SUCCESS: 'gallery',\n        SEARCH_FAILURE: 'error',\n        CANCEL_SEARCH: 'gallery',\n      },\n      onEntry: 'enterLoading',\n      onExit: 'exitLoading',\n    },\n    error: {\n      on: {\n        SEARCH: 'loading',\n      },\n      onEntry: 'enterError',\n    },\n    gallery: {\n      on: {\n        SEARCH: 'loading',\n        SELECT_PHOTO: 'photo',\n      },\n      onEntry: 'enterGallery',\n    },\n    photo: {\n      on: {\n        EXIT_PHOTO: 'gallery',\n      },\n      onEntry: 'enterPhoto',\n    },\n  },\n}\n\nclass Gallery extends React.Component {\n  state = {\n    disableForm: false,\n    query: '',\n    searchText: 'Search',\n  }\n\n  enterLoading() {\n    this.setState({\n      disableForm: true,\n      searchText: 'Searching...',\n    })\n\n    const encodedQuery = encodeURIComponent(this.state.query)\n    setTimeout(() => {\n      fetchJsonp(\n        `https://api.flickr.com/services/feeds/photos_public.gne?lang=en-us&format=json&tags=${encodedQuery}`,\n        { jsonpCallback: 'jsoncallback' }\n      )\n        .then(res => res.json())\n        .then(({ items }) => this.props.transition('SEARCH_SUCCESS', { items }))\n        .catch(() => this.props.transition('SEARCH_FAILURE'))\n    }, 1000)\n  }\n\n  exitLoading() {\n    this.setState({\n      disableForm: false,\n      searchText: 'Search',\n    })\n  }\n\n  enterError() {\n    this.setState({\n      searchText: 'Try search again',\n    })\n  }\n\n  handleSubmit = e => {\n    e.preventDefault()\n    this.props.transition('SEARCH')\n  }\n\n  handleChangeQuery = e => {\n    this.setState({ query: e.target.value })\n  }\n\n  render() {\n    return (\n      <div className=\"ui-app\" data-state={this.props.machineState}>\n        <form className=\"ui-form\" onSubmit={this.handleSubmit}>\n          <input\n            className=\"ui-input\"\n            disabled={this.state.disableForm}\n            placeholder=\"Search \"\n            type=\"search\"\n            value={this.state.query}\n            onChange={this.handleChangeQuery}\n          />\n          <div className=\"ui-buttons\">\n            <button className=\"ui-button\" disabled={this.state.disableForm}>\n              {this.state.searchText}\n            </button>\n            <Action show=\"enterLoading\">\n              <button\n                className=\"ui-button\"\n                type=\"button\"\n                onClick={() => this.props.transition('CANCEL_SEARCH')}\n              >\n                Cancel\n              </button>\n            </Action>\n          </div>\n        </form>\n\n        <section className=\"ui-items\">\n          <Action show=\"enterError\">\n            <span className=\"ui-error\">Uh oh, search failed.</span>\n          </Action>\n          {this.props.items.map((item, i) => (\n            <img\n              className=\"ui-item\"\n              key={item.link}\n              src={item.media.m}\n              style={{ '--i': i }}\n              onClick={() =>\n                this.props.transition('SELECT_PHOTO', { photo: item })}\n            />\n          ))}\n        </section>\n\n        <Action show=\"enterPhoto\">\n          <section\n            className=\"ui-photo-detail\"\n            onClick={() => this.props.transition('EXIT_PHOTO')}\n          >\n            <img className=\"ui-photo\" src={this.props.photo.media.m} />\n          </section>\n        </Action>\n      </div>\n    )\n  }\n}\n\nconst initialData = {\n  items: [],\n  photo: {\n    media: {},\n  },\n}\n\nconst App = withStatechart(statechart, { initialData })(Gallery)\n\nReactDOM.render(<App />, document.getElementById('root'))\n"],"sourceRoot":""}